<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RuneHearth</title>
  <link rel="preload" href="Public/Hammer.png" as="image" fetchpriority="high" />
  <link rel="stylesheet" href="css/styles.css?v=9" />
</head>
<body>
  
<!-- MAGIC BOOK: GLOSSARY & VERSE (draggable, toggleable) -->
  <div id="magicBook" class="magic-book open" style="display:none;">
    <button id="bookToggleBtn" class="book-toggle-btn" title="Open/Close Book">üìñ</button>
    <button id="bookCloseBtn" class="book-close-btn" title="Close Book">‚úï</button>
    <!-- Book cover (shown when closed) -->
    <div class="book-cover">
      <div class="book-cover-spine"></div>
      <div class="book-cover-front">
        <div class="book-cover-title">Verse</div>
        <div class="book-cover-subtitle">Foundations of Magic</div>
        <div class="book-cover-ornament">‚ú¶</div>
      </div>
    </div>
    <!-- Book interior (shown when open) -->
    <div class="book-interior">
      <div class="book-spine"></div>

      <!-- GLOSSARY PAGE (left page) -->
      <div class="book-page book-page-left" id="glossaryPage">
        <div class="book-page-header">Glossary</div>
        <div class="book-page-content">
          <div id="glossaryEntries" class="glossary-entries">
            <div class="glossary-empty" style="opacity:0.6; font-size:12px;">No words forged yet.</div>
          </div>
        </div>
      </div>

      <!-- VERSE PAGE (right page) -->
      <div class="book-page book-page-right" id="versePage">
        <div class="book-page-header">Assembly</div>
        <div class="book-page-content">
          <div style="font-size:12px; opacity:0.8;">Verse</div>
          <div id="grammarNatural" style="font-size:14px; font-weight:600; min-height:20px;"></div>
          <div id="grammarScore" style="font-size:11px; opacity:0.7; margin-top:4px;"></div>
          <div id="grammarHebrewLine" class="letter-board"></div>

          <!-- Word Selector -->
          <div id="wordSelectorContainer" class="word-selector-container">
            <button id="wordSelectorPrev" class="word-selector-arrow" title="Previous word">&#9664;</button>
            <div id="wordSelectorDisplay" class="word-selector-display">
              <span class="word-selector-empty">No words available</span>
            </div>
            <button id="wordSelectorNext" class="word-selector-arrow" title="Next word">&#9654;</button>
          </div>
          <div class="word-selector-actions">
            <button id="wordSelectorEnterBtn" class="word-selector-enter-btn" disabled>Enter Word</button>
            <button id="wordSelectorEraseBtn" class="word-selector-erase-btn">Erase</button>
          </div>

          <div class="row" style="margin-top:10px;">
            <button id="enscribeBtn" disabled>Enscribe Line</button>
            <span class="pill">Lines completed: <span id="linesCompleted">0</span></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hidden elements for backward compat (grammar evaluation still uses these) -->
  <div style="display:none;">
    <div id="grammarTranslit"></div>
    <div id="grammarLiteral"></div>
  </div>

  <!-- RIGHT-SIDE TOOLS SIDEBAR -->
  <div id="toolsSidebar" class="tools-sidebar">
    <div class="tools-sidebar-tab">Tools</div>
    <div class="tools-sidebar-content">
      <div class="tool-slot" data-tool="book" id="toolSlotBook">
        <div class="tool-slot-icon">üìñ</div>
        <div class="tool-slot-label">Verse</div>
      </div>
      <div class="tool-slot active" data-tool="hammer" id="toolSlotHammer">
        <div class="tool-slot-icon">üî®</div>
        <div class="tool-slot-label">Hammer</div>
      </div>
      <div class="tool-slot" data-tool="spyglass" id="toolSlotSpyglass">
        <div class="tool-slot-icon">üîç</div>
        <div class="tool-slot-label">Spyglass</div>
      </div>
      <div class="tool-slot locked-hidden" data-tool="pestle" id="toolSlotPestle">
        <div class="tool-slot-icon">ü•Ñ</div>
        <div class="tool-slot-label">Pestle</div>
      </div>
      <div class="tool-slot locked-hidden" data-tool="shovel" id="toolSlotShovel">
        <div class="tool-slot-icon">üß∞</div>
        <div class="tool-slot-label">Shovel</div>
      </div>
    </div>
  </div>

  <!-- Hidden original tool buttons for JS compatibility -->
  <div style="display:none;">
    <button id="selectHammer" class="tool-button active" data-tool="hammer"></button>
    <button id="selectSpyglass" class="tool-button" data-tool="spyglass"></button>
    <button id="selectPestle" class="tool-button locked-hidden" data-tool="pestle"></button>
    <button id="selectShovel" class="tool-button locked-hidden" data-tool="shovel"></button>
  </div>

  <!-- WORKERS PANEL FIXED BELOW RESOURCES -->
  <div class="workers-panel">
    <div class="section">
      <div id="scribeBlocks" class="scribe-grid scribe-hire-grid" aria-label="Scribes"></div>
    </div>
  </div>
  
  <!-- CRAFTING FORGE (HAMMER OR PESTLE) -->
  <div class="crafting-forge">
    <canvas id="craftingCanvas"></canvas>
  </div>
  <div class="letter-block-layer">
    <canvas id="letterBlocksCanvas"></canvas>
  </div>

  <!-- FLOATING STATS -->
  <div class="stats-wrap">
    <div class="resource-controls">
      <div class="section core-stats-float">
        <div class="stat-row"><span>‚≠ê Renown</span><strong id="lettersDisplay">0</strong></div>
        <div class="stat-row"><span>üíß Ink</span><strong id="inkDisplay">0</strong></div>
      </div>
      <button id="fullscreenToggleBtn" class="fullscreen-toggle-btn" type="button" title="Toggle fullscreen">
        <span class="fullscreen-toggle-icon">‚õ∂</span>
      </button>
    </div>
  </div>

  <!-- UPGRADES BUTTON (TOP RIGHT) -->
  <button id="upgradesBtn" class="upgrades-btn">
    <span class="upgrades-btn-icon">&#x2728;</span>
    <span class="upgrades-btn-label">Upgrades</span>
  </button>

  <!-- AUDIO MUTE TOGGLE -->
  <button id="audioToggleBtn" class="audio-toggle-btn" title="Audio controls">
    <span class="audio-toggle-icon">&#x1F50A;</span>
  </button>
  <div id="audioControls" class="audio-controls-panel hidden" aria-label="Audio controls">
    <div class="audio-controls-title">Audio</div>
    <label class="audio-controls-row">
      <span class="audio-controls-label">Music</span>
      <input id="musicVolumeSlider" class="audio-controls-slider" type="range" min="0" max="1" step="0.01" />
      <span id="musicVolumeValue" class="audio-controls-value">30%</span>
    </label>
    <label class="audio-controls-row">
      <span class="audio-controls-label">SFX</span>
      <input id="sfxVolumeSlider" class="audio-controls-slider" type="range" min="0" max="1" step="0.01" />
      <span id="sfxVolumeValue" class="audio-controls-value">50%</span>
    </label>
  </div>

  <!-- HEARTH (FIXED AT BOTTOM CENTER) -->
  <div class="hearth-wrapper">
    <!-- HEARTH STRUCTURE -->
    <div id="hearth" class="hearth-structure">
      <!-- Hearth mantle/top -->
      <div class="hearth-mantle"></div>

      <!-- Hearth arch and opening -->
      <div class="hearth-body">
        <div class="hearth-arch">
          <div class="hearth-arch-left"></div>
          <div class="hearth-arch-top"></div>
          <div class="hearth-arch-right"></div>
        </div>

        <!-- Fire chamber (interior) -->
        <div class="hearth-opening">
          <div class="hearth-back-wall"></div>
          <div id="hearthFire" class="hearth-fire"></div>
          <div class="hearth-floor"></div>
        </div>
      </div>

      <!-- Hearth base/foundation -->
      <div class="hearth-base"></div>
    </div>

  </div>

  <!-- LETTER BASKET (FIXED AT BOTTOM LEFT) -->
  <div class="letter-basket">
    <div class="letter-basket-header">
      <div class="basket-title"></div>
      <div class="basket-subtitle"></div>
    </div>
    <div id="letterPool" class="letter-board letter-basket-board"></div>
  </div>

  <!-- UPGRADE MODAL -->
  <div id="upgradeModal" class="upgrade-modal hidden">
    <div class="upgrade-modal-content">
      <div class="upgrade-modal-header">
        <h2>Upgrades</h2>
        <div class="upgrade-header-stats">
          <span class="upgrade-resource">‚≠ê <strong id="upgradeRenown">0</strong></span>
          <span class="upgrade-resource">üíß <strong id="upgradeInk">0</strong></span>
        </div>
        <button id="closeUpgradeBtn" class="close-button">‚úï</button>
      </div>
      <div class="upgrade-columns">
        <!-- LEFT COLUMN: Workshop (tool blocks) -->
        <div class="upgrade-column" id="workshopColumn">
          <div class="upgrade-column-header">Workshop</div>
          <div class="upgrade-block-list" id="workshopList"></div>
        </div>
        <!-- RIGHT COLUMN: Forgecraft (stat upgrades) -->
        <div class="upgrade-column" id="forgecraftColumn">
          <div class="upgrade-column-header">Forgecraft</div>
          <div class="upgrade-block-list" id="forgecraftList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Load JavaScript modules -->
  <script type="module" src="js/app.js?v=9"></script>
</body>
</html>
